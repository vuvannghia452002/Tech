\NeedsTeXFormat{LaTeX2e}
\RequirePackage{geometry}
\geometry{left=2.5cm, right=2.5cm, top=2.5cm, bottom=2.5cm, a4paper}
\RequirePackage{fix-cm}
\RequirePackage{tikz}
\usetikzlibrary{shapes.geometric, shapes.symbols}
\RequirePackage{enumitem}
\RequirePackage{xcolor}
% \definecolor{HustRed}{RGB}{206,22,40}
\definecolor{HustRed}{RGB}{205,5,5}
% \definecolor{HustRed}{RGB}{25,45,150}
\RequirePackage{tcolorbox}
\RequirePackage{fancyhdr}
\fancyhf{}
\pagestyle{fancy}
\setlength\footskip{20pt}
\renewcommand{\headrulewidth}{1pt}
\renewcommand{\headrule}{\hbox to\headwidth{\color{\@usecolor}\leaders\hrule height \headrulewidth\hfill}}
\if@twoside
\fancyfoot[RE]{
\makebox[1cm][l]{
    \begin{tikzpicture}[baseline]
    \node[anchor=base, signal, font=\bfseries, text=white, signal to=west, fill=\@usecolor, text width=\evensidemargin+1in+1cm, align=left](re){\sffamily\thepage};
    \draw[overlay, \@usecolor, line width=1pt] (re.west)--++(-\textwidth+1cm,0);
    \end{tikzpicture} 
    }
}
\fancyfoot[LO]{
\makebox[1cm][r]{
    \begin{tikzpicture}[baseline]
    \node[anchor=base, signal, font=\bfseries, text=white, signal to=east, fill=\@usecolor, text width=\oddsidemargin+1in+1cm, align=right](lo){\sffamily\thepage};
    \draw[overlay, \@usecolor, line width=1pt] (lo.east)--++(\textwidth-1cm,0);
    \end{tikzpicture} }
}
\fancyfoot[LE,RO]{
\mbox{
    \begin{tikzpicture}[baseline]
    \node[anchor=north, font=\bfseries, text=\@usecolor, fill=white, rectangle, inner sep=0pt]{\sffamily copyright};
    \end{tikzpicture}
    }
}
\else
\rfoot{\makebox[1cm][l]{
    \begin{tikzpicture}[baseline]
    \node[anchor=base, signal, font=\bfseries, text=white, signal to=west, fill=\@usecolor, text width=\evensidemargin+1in+1cm, align=left](re){\sffamily\thepage};
    \draw[overlay, \@usecolor, line width=1pt] (re.west)--++(-\textwidth+1cm,0);
    \end{tikzpicture}
    }
}
\lfoot{\mbox{
    \begin{tikzpicture}[baseline]
    \node[anchor=north, font=\bfseries, text=\@usecolor, fill=white, rectangle, inner sep=0pt]{\sffamily copyright};
    \end{tikzpicture}
    }
}
\fi
\RequirePackage[explicit]{titlesec}
\titleformat{\section}[hang]
{\bfseries\sffamily}
{\filright
\begin{tikzpicture}
\node[inner xsep=2pt,
font=\color{white},minimum height=1cm,
align=center, diamond, fill = \@usecolor, aspect=1.5
]{\Large\thesection};
\end{tikzpicture}
}
{-15pt}
{
\begin{tikzpicture}
 \node[inner xsep=5pt,
    align=left,  minimum height=1cm, signal, signal from=west, fill=\@usecolor, font=\color{white}, signal pointer angle = 67.38]
    {\mbox{\Large\bfseries\raggedright\strut\hspace{3pt}#1
    }};
\end{tikzpicture}}
\titleformat{\subsection}
{\large\bfseries\color{\@usecolor}}
{\thesubsection}{7.5pt}{#1}
\titleformat{\subsubsection}
{\bfseries\color{\@usecolor}}
{\thesubsubsection}{7.5pt}{#1}
\def\@insertlogo{}
\newcommand{\logo}[2][]{
\gdef\@insertlogo{\includegraphics[#1]{#2}}}
\def\subtitle#1{\gdef\@subtitle{#1}}
\def\@subtitle{\@latex@error{No \noexpand\subtitle given}\@ehc}
\def\info#1{\gdef\@info{#1}}
\def\@info{\@latex@error{No \noexpand\info given}\@ehc}
\def\usecolor#1{\gdef\@usecolor{#1}}
\def\@maketitle{
\newpage\null
\thispagestyle{empty}
\begin{tikzpicture}[remember picture, overlay]
\begin{scope}[shift=(current page.north west), x={(current page.north east)},y={(current page.south west)}]
\fill[\@usecolor, opacity = 0.5] (0,0.09)|-(0.9,0)--cycle;
\fill[\@usecolor, opacity = 0.5] (0,0.15)|-(0.72,0)--cycle;
\fill[\@usecolor, opacity = 0.5] (0,0.15)|-(0.45,0)--cycle;
\end{scope}
\begin{scope}[thin, scale=3.5, rotate=-25, shift=(current page.north east), yshift = -0.035\paperheight, xshift = -0.04\paperwidth]
    \coordinate (A1) at (0,0);
    \coordinate (A2) at (0.6,0.2);
    \coordinate (A3) at (1,0);
    \coordinate (A4) at (0.4,-0.2);
    \coordinate (B1) at (0.5,0.5);
    \coordinate (B2) at (0.5,-0.5);
    \fill[fill=\@usecolor,opacity=0.7] (A1)--(A4)--(B1)--cycle;
    \fill[fill=\@usecolor,opacity=1] (A1)--(A4)--(B2)--cycle;
    \fill[fill=\@usecolor,opacity=0.4] (A3)--(A4)--(B1)--cycle;
    \fill[fill=\@usecolor,opacity=0.7] (A3)--(A4)--(B2)--cycle;
\end{scope}
\begin{scope}[shift=(current page.south east), x={(current page.south west)},y={(current page.north east)}]
\fill[\@usecolor, opacity = 0.5] (0,0.09)|-(0.9,0)--cycle;
\fill[\@usecolor, opacity = 0.5] (0,0.15)|-(0.72,0)--cycle;
\fill[\@usecolor, opacity = 0.5] (0,0.15)|-(0.45,0)--cycle;
\end{scope}
\begin{scope}[thin,scale=1.3, rotate = 10, shift=(current page.south east), yshift = 0.2\paperheight, xshift = -0.075\paperwidth]
    \coordinate (a1) at (0,-0.5);
    \coordinate (a2) at (0.9,0);
    \coordinate (a3) at (1.8,-0.5);
    \coordinate (a4) at (1.8,-1.55);
    \coordinate (a5) at (0.9,-2.1);
    \coordinate (a6) at (0,-1.55);
    \coordinate (b1) at (0.35,-1.4);
    \coordinate (b2) at (0.9,-0.45);
    \coordinate (b3) at (1.45,-1.4);
    \coordinate (c1) at (0.5,-0.8);
    \coordinate (c2) at (1.3,-0.8);
    \coordinate (c3) at (0.9,-1.7);
    \fill[fill=\@usecolor,opacity=0.35] (a1)--(b2)--(a2)--cycle;
    \fill[fill=\@usecolor,opacity=0.4] (a3)--(b2)--(a2)--cycle;
    \fill[fill=\@usecolor,opacity=0.45] (a1)--(b2)--(b1)--cycle;
    \fill[fill=\@usecolor,opacity=0.6] (a3)--(b2)--(b3)--cycle;
    \fill[fill=\@usecolor,opacity=0.55] (a1)--(b1)--(a6)--cycle;
    \fill[fill=\@usecolor,opacity=0.65] (b1)--(b2)--(b3)--cycle;
    \fill[fill=\@usecolor,opacity=0.75] (a4)--(a3)--(b3)--cycle;
    \fill[fill=\@usecolor,opacity=0.75] (a5)--(b1)--(b3)--cycle;
    \fill[fill=\@usecolor,opacity=0.7] (a6)--(b1)--(a5)--cycle;
    \fill[fill=\@usecolor,opacity=0.85] (a5)--(b3)--(a4)--cycle;
\end{scope}
\begin{scope}
    \node[below right, xshift = 0.1\paperwidth, yshift = -0.14\paperheight] at (current page.north west) {\@insertlogo};
\end{scope}
\end{tikzpicture}
\begin{flushleft}
\let \footnote \thanks 
{\fontsize{50}{14}\selectfont\sffamily\bfseries\vspace{5cm}\color{\@usecolor}\@title\vskip5pt\Huge\@subtitle\par}
\vskip 4cm
{\large\lineskip 0.5em
\@info\vskip5pt
\begin{tabular}[t]{ll}
\@author
\end{tabular}\par}
\vskip 1.5cm
{\large \@date}
\end{flushleft}
\par
}

\newenvironment{block}[1]
{ \begin{tcolorbox}[%
      colback=white,
      colframe=\@usecolor,
      arc=3mm,
      title={\textbf{#1}},
      colbacktitle=\@usecolor,
      coltitle=white,
      boxrule=2pt,
     % detach title,
      before upper={\tcbtitle\vskip0pt\par}
    ]
    \begin{minipage}{\textwidth}}
{\end{minipage}
\end{tcolorbox}}
\setlist{format={\color{\@usecolor}\bfseries}}
\newcommand{\maketitlepage}{
\maketitle
\thispagestyle{empty}
\newpage
\setcounter{page}{1}
}
\usecolor{HustRed}
